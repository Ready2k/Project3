[mypy]
# Global mypy configuration for strict type checking

# Basic configuration
python_version = 3.10
warn_return_any = True
warn_unused_configs = True

# Gradual typing - start with less strict settings
disallow_any_generics = False
disallow_subclassing_any = False
disallow_untyped_calls = False
disallow_untyped_defs = False
disallow_incomplete_defs = False
check_untyped_defs = True
disallow_untyped_decorators = False
no_implicit_optional = False

# Warnings that are helpful
warn_redundant_casts = True
warn_unused_ignores = True
warn_no_return = True
warn_unreachable = True
strict_equality = True
extra_checks = True

# Error output
show_error_codes = True
show_column_numbers = True
show_error_context = True
color_output = True
error_summary = True

# Import discovery
namespace_packages = True
explicit_package_bases = True

# Cache
cache_dir = .mypy_cache
sqlite_cache = True

# Files to check
files = app/

# Exclude patterns
exclude = ^(app/tests/fixtures/.*\.py|app/tests/.*test.*\.py|build/|dist/|\.venv/|venv/|\.mypy_cache/)$

# Per-module options for third-party libraries without stubs
[mypy-streamlit.*]
ignore_missing_imports = True

[mypy-streamlit_mermaid.*]
ignore_missing_imports = True

[mypy-redis.*]
ignore_missing_imports = True

[mypy-diskcache.*]
ignore_missing_imports = True

[mypy-sentence_transformers.*]
ignore_missing_imports = True

[mypy-faiss.*]
ignore_missing_imports = True

[mypy-diagrams.*]
ignore_missing_imports = True

[mypy-psutil.*]
ignore_missing_imports = True

[mypy-slowapi.*]
ignore_missing_imports = True

[mypy-loguru.*]
ignore_missing_imports = True

[mypy-boto3.*]
ignore_missing_imports = True

[mypy-botocore.*]
ignore_missing_imports = True

[mypy-anthropic.*]
ignore_missing_imports = True

[mypy-openai.*]
ignore_missing_imports = True

[mypy-git.*]
ignore_missing_imports = True

[mypy-hypothesis.*]
ignore_missing_imports = True

# Per-module options for specific app modules that may need relaxed rules during migration
[mypy-app.tests.*]
# Allow more flexibility in test files
disallow_untyped_defs = False
disallow_incomplete_defs = False
disallow_untyped_calls = False
check_untyped_defs = False

# Legacy modules that may need gradual typing
[mypy-app.legacy.*]
disallow_untyped_defs = False
disallow_incomplete_defs = False
warn_return_any = False

# Specific modules with known issues (to be fixed incrementally)
[mypy-app.ui.mermaid_diagrams]
disallow_any_generics = False

[mypy-app.services.jira]
disallow_any_generics = False

[mypy-app.services.jira_auth]
disallow_any_generics = False

[mypy-app.services.jira_auth_handlers]
disallow_any_generics = False

[mypy-app.services.jira_diagnostics]
disallow_any_generics = False

[mypy-app.services.jira_error_handler]
ignore_errors = True

# Plugins
plugins = pydantic.mypy

# Pydantic plugin configuration
[pydantic-mypy]
init_forbid_extra = True
init_typed = True
warn_required_dynamic_aliases = True
warn_untyped_fields = True